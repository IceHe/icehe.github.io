<!doctype html><html class="theme-next mist" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="google34949e442e488102"><meta name="baidu-site-verification" content="04tLeUMqMf"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="https://fonts.css.network/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css"><meta name="keywords" content="IceHe"><link rel="alternate" href="/atom.xml" title="IceHe" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/images/alphabet_letter_h.ico?v=5.1.1"><meta name="description" content="Bash脚本https://github.com/ruanyf/articles/tree/master/dev/bashhttp://www.linux-sxs.org/programming/bashcheat.html上一阶段学Bash的参考资料：≈http://www.mediacollege.com/cgi-bin/man/page.cgi?topic=bashhttp://ahei.i"><meta property="og:type" content="website"><meta property="og:title" content="Bash - Note"><meta property="og:url" content="http://icehe.me/notes/bash.html"><meta property="og:site_name" content="IceHe"><meta property="og:description" content="Bash脚本https://github.com/ruanyf/articles/tree/master/dev/bashhttp://www.linux-sxs.org/programming/bashcheat.html上一阶段学Bash的参考资料：≈http://www.mediacollege.com/cgi-bin/man/page.cgi?topic=bashhttp://ahei.i"><meta property="og:updated_time" content="2016-06-03T12:25:59.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Bash - Note"><meta name="twitter:description" content="Bash脚本https://github.com/ruanyf/articles/tree/master/dev/bashhttp://www.linux-sxs.org/programming/bashcheat.html上一阶段学Bash的参考资料：≈http://www.mediacollege.com/cgi-bin/man/page.cgi?topic=bashhttp://ahei.i"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{display:"always",offset:12,offset_float:0,b2t:!1,scrollpercent:!0},fancybox:!0,motion:!1,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://icehe.me/notes/bash.html"><title>Bash - Note | IceHe</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ba81ef13fc65c4dcf8cf8586d25818a4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">IceHe</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">More is in vain when less will serve.</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-quote-left"></i><br>文章</a></li><li class="menu-item menu-item-nav"><a href="/bookmarks" rel="section"><i class="menu-item-icon fa fa-fw fa-bookmark"></i><br>导航</a></li><li class="menu-item menu-item-cv"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-star"></i><br>简历</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav><style type="text/css">.bold{font-weight:700}.center{text-align:center}.hidden{display:none}.no_underline{border-bottom:0}.white{color:#fff}.pace .pace-progress{background:#000}</style></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><header class="post-header"><h2 class="post-title" itemprop="name headline">Bash - Note</h2></header><p><a href="https://github.com/ruanyf/articles/blob/master/dev/linux/script.md" target="_blank" rel="external">Bash脚本</a></p><p><a href="https://github.com/ruanyf/articles/tree/master/dev/bash" target="_blank" rel="external">https://github.com/ruanyf/articles/tree/master/dev/bash</a></p><p><a href="http://www.linux-sxs.org/programming/bashcheat.html" target="_blank" rel="external">http://www.linux-sxs.org/programming/bashcheat.html</a></p><p>上一阶段学Bash的参考资料：<br>≈<br><a href="http://www.mediacollege.com/cgi-bin/man/page.cgi?topic=bash" target="_blank" rel="external">http://www.mediacollege.com/cgi-bin/man/page.cgi?topic=bash</a><br><a href="http://ahei.info/chinese-bash-man.htm" target="_blank" rel="external">http://ahei.info/chinese-bash-man.htm</a><br><a href="https://www.gnu.org/software/bash/manual/bashref.html" target="_blank" rel="external">https://www.gnu.org/software/bash/manual/bashref.html</a><br><a href="http://tldp.org/LDP/Bash-Beginners-Guide/html/index.html" target="_blank" rel="external">http://tldp.org/LDP/Bash-Beginners-Guide/html/index.html</a></p><p><a href="http://alvinalexander.com/blog/post/linux-unix/unix-linux-shell-script-reference-cheat-sheet" target="_blank" rel="external">http://alvinalexander.com/blog/post/linux-unix/unix-linux-shell-script-reference-cheat-sheet</a></p><p><a href="http://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/refcards.html" target="_blank" rel="external">http://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/refcards.html</a></p><p>If bash is invoked in this fashion, $0 is set to the name of the file, and the positional parameters are set to the remaining arguments. Bash reads and executes commands from this file, then exits. Bash’s exit status is the exit status of the last command executed in the script. If no commands are executed, the exit status is 0.</p><p>When a login shell exits, bash reads and executes commands from the file ~/.bash_logout, if it exists.</p><p>login shell 读取 ~/.bash_profile, ~/.bash_login, and ~/.profile<br>not login shell 读取 ~/.bashrc</p><p>non-interactive shell: to run a shell script</p><h1 id="DEFINITIONS"><a href="#DEFINITIONS" class="headerlink" title="DEFINITIONS"></a>DEFINITIONS</h1><p>blank A space or tab.</p><p>word A sequence of characters considered as a single unit by the shell. Also known as a token.</p><p>name A word consisting only of alphanumeric characters and underscores, and beginning with an alphabetic character or an underscore. Also referred to as an identifier.</p><p>metacharacter A character that, when unquoted, separates words. One of the following: | &amp; ; ( ) &lt; &gt; space tab</p><p>control operator A token that performs a control function. It is one of the following symbols: || &amp; &amp;&amp; ; ;; ( ) |<newline></newline></p><h1 id="RESERVED-WORDS"><a href="#RESERVED-WORDS" class="headerlink" title="RESERVED WORDS"></a>RESERVED WORDS</h1><p>Reserved words are words that have a special meaning to the shell. The following words are recognized as reserved when unquoted and either the first word of a simple command (see SHELL GRAMMAR below) or the third word of a case or for command:</p><pre><code>!  case   do done elif else esac fi for function if in select then until while { } time [[ ]]
</code></pre><h1 id="Pipelines"><a href="#Pipelines" class="headerlink" title="Pipelines"></a>Pipelines</h1><p>A pipeline is a sequence of one or more commands separated by the character |. The format for a pipeline is:</p><pre><code>[time [-p]] [ ! ] command [ | command2 ... ]
</code></pre><p>If the time reserved word precedes a pipeline, the elapsed as well as user and system time consumed by its execution are reported when the pipeline terminates. The -p option changes the output format to that specified by POSIX. The TIMEFORMAT variable may be set to a format string that specifies how the timing information should be displayed; see the description of TIMEFORMAT under Shell Variables below.</p><p>Each command in a pipeline is executed as a separate process (i.e., in a subshell).</p><h1 id="List-序列"><a href="#List-序列" class="headerlink" title="List 序列"></a>List 序列</h1><p>If a command is terminated by the control operator &amp;, the shell executes the command in the background in a subshell. The shell does not wait for the command to finish, and the return status is 0. Commands separated by a ; are executed sequentially; the shell waits for each command to terminate in turn. The return status is the exit status of the last command executed</p><p>＃ Compound Commands</p><p>(list)</p><p>list is executed in a subshell environment (see COMMAND EXECUTION ENVIRONMENT below). Variable assignments and builtin commands that affect the shell’s environment do not remain in effect after the command completes. The return status is the exit status of list.</p><p>{ list; }</p><p>list is simply executed in the current shell environment. list must be terminated with a newline or semicolon. This is known as a group command. The return status is the exit status of list. Note that unlike the metacharacters ( and ), { and } are reserved words and must occur where a reserved word is permitted to be recognized. Since they do not cause a word break, they must be separated from list by whitespace.</p><p>((expression))<br>The expression is evaluated according to the rules described below under ARITHMETIC EVALUATION. If the value of the expression is non-zero, the return status is 0; otherwise the return status is 1. This is exactly equivalent to let “expression”.</p><p>[[ expression ]]<br>Return a status of 0 or 1 depending on the evaluation of the conditional expresMETIC EVALUATION. If the value of the expression is non-zero, the return status is 0; otherwise the return status is 1. This is exactly equivalent to let “expression”.</p><p>[[ expression ]]<br>Return a status of 0 or 1 depending on the evaluation of the conditional expression expression. Expressions are composed of the primaries described below under CONDITIONAL EXPRESSIONS. Word splitting and pathname expansion are not performed on the words between the [[ and ]]; tilde expansion, parameter and variable expansion, arithmetic expansion, command substitution, process substitution, and quote removal are performed. Conditional operators such as -f must be unquoted to be recognized as primaries.</p><p>When the == and != operators are used, the string to the right of the operator is considered a pattern and matched according to the rules described below under Pattern Matching. If the shell option nocasematch is enabled, the match is performed without regard to the case of alphabetic characters. The return value is 0 if the string matches (==) or does not match (!=) the pattern, and 1 otherwise. Any part of the pattern may be quoted to force it to be matched as a string.</p><p>An additional binary operator, =~, is available, with the same precedence as == and !=. When it is used, the string to the right of the operator is considered an extended regular expression and matched accordingly (as in regex(3)). The return value is 0 if the string matches the pattern, and 1 otherwise. If the regular expression is syntactically incorrect, the conditional expression’s return value is 2. If the shell option nocasematch is enabled, the match is performed without regard to the case of alphabetic characters. Substrings matched by parenthesized subexpressions within the regular expression are saved in the array variable BASH_REMATCH. The element of BASH_REMATCH with index 0 is the portion of the string matching the entire regular expression. The element of BASH_REMATCH with index n is the portion of the string matching the nth parenthesized subexpression.</p><p>Expressions may be combined using the following operators, listed in decreasing order of precedence:</p><p>( expression ) Returns the value of expression. This may be used to override the normal precedence of operators</p><p>for name [ in word ] ; do list ; done</p><p>The list of words following in is expanded, generating a list of items. The variable name is set to each element of this list in turn, and list is executed each time. If the in word is omitted, the for command executes list once for each positional parameter that is set (see PARAMETERS below). The return status is the exit status of the last command that executes. If the expansion of the items following in results in an empty list, no commands are executed, and the return status is 0.</p><p>for (( expr1 ; expr2 ; expr3 )) ; do list ; done</p><p>First, the arithmetic expression expr1 is evaluated according to the rules described below under ARITHMETIC EVALUATION. The arithmetic expression expr2 is then evaluated repeatedly until it evaluates to zero. Each time expr2 evaluates to a non-zero value, list is executed and the arithmetic expression expr3 is evaluated. If any expression is omitted, it behaves as if it evaluates to 1. The return value is the exit status of the last command in list that is executed, or false if any of the expressions is invalid.</p><p>select name [ in word ] ; do list ; done</p><p>case word in [ [(] pattern [ | pattern ] … ) list ;; ] … esac</p><p>if list; then list; [ elif list; then list; ] … [ else list; ] fi</p><p>while list; do list; done<br>until list; do list; done</p><p>[ function ] name () compound-command [redirection]</p><p>This defines a function named name. The reserved word function is optional. If the function reserved word is supplied, the parentheses are optional. The body of the function is the compound command compound-command (see Compound Commands above). That command is usually a list of commands between { and }, but may be any command listed under Compound Commands above. compound-command is executed whenever name is specified as the name of a simple command. Any redirections (see REDIRECTION below) specified when a function is defined are performed when the function is executed. The exit status of a function definition is zero unless a syntax error occurs or a readonly function with the same name already exists. When executed, the exit status of a function is the exit status of the last command executed in the body. (See FUNCTIONS below.)</p><h1 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h1><p>A word beginning with # causes that word and all remaining characters on that line to be ignored.</p><h1 id="Quotes"><a href="#Quotes" class="headerlink" title="Quotes"></a>Quotes</h1><p>A non-quoted backslash () is the escape character. It preserves the literal value of the next character that follows, with the exception of<newline>. If a \<newline>pair appears, and the backslash is not itself quoted, the \<newline>is treated as a line continuation (that is, it is removed from the input stream and effectively ignored).</newline></newline></newline></p><p>Enclosing characters in single quotes preserves the literal value of each character within the quotes. A single quote may not occur between single quotes, even when preceded by a backslash.</p><p>Enclosing characters in double quotes preserves the literal value of all characters within the quotes, with the exception of $, <code>, \, and, when history expansion is enabled, !. The characters $ and</code> retain their special meaning within double quotes. The backslash retains its special meaning only when followed by one of the following characters: $, `, “, \, or<newline>. A double quote may be quoted within double quotes by preceding it with a backslash. If enabled, history expansion will be performed unless an ! appearing in double quotes is escaped using a backslash. The backslash preceding the ! is not removed.</newline></p><p>Words of the form $’string’ are treated specially. The word expands to string, with backslash-escaped characters replaced as specified by the ANSI C standard. Backslash escape sequences, if present, are decoded as follows:<br>\a alert (bell)<br>\b backspace<br>\e an escape character<br>\f form feed<br>\n new line<br>\r carriage return<br>\t horizontal tab<br>\v vertical tab<br>\ backslash<br>\’ single quote<br>\nnn the eight-bit character whose value is the octal value nnn (one to three digits)<br>\xHH the eight-bit character whose value is the hexadecimal value HH (one or two hex digits)<br>\cx a control-x character</p><h1 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h1><p>A variable has a value and zero or more attributes. Attributes are assigned using the declare builtin command (see declare below in SHELL BUILTIN COMMANDS).</p><p>A parameter is set if it has been assigned a value. The null string is a valid value. Once a variable is set, it may be unset only by using the unset builtin command.</p><p>A variable may be assigned to by a statement of the form</p><pre><code>name=[value]
</code></pre><p>If value is not given, the variable is assigned the null string. All values undergo tilde expansion, parameter and variable expansion, command substitution, arithmetic expansion, and quote removal (see EXPANSION below). If the variable has its integer attribute set, then value is evaluated as an arithmetic expression even if the $((…)) expansion is not used (see Arithmetic Expansion below). Word splitting is not performed, with the exception of “$@” as explained below under Special Parameters. Pathname expansion is not performed. Assignment statements may also appear as arguments to the alias, declare, typeset, export, readonly, and local builtin commands.</p><h1 id="Positional-Parameters"><a href="#Positional-Parameters" class="headerlink" title="Positional Parameters"></a>Positional Parameters</h1><p>A positional parameter is a parameter denoted by one or more digits, other than the single digit 0. Positional parameters are assigned from the shell’s arguments when it is invoked, and may be reassigned using the set builtin command. Positional parameters may not be assigned to with assignment statements. The positional parameters are temporarily replaced when a shell function is executed (see FUNCTIONS below).</p><p>When a positional parameter consisting of more than a single digit is expanded, it must be enclosed in braces</p><h1 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h1><p>Bash provides one-dimensional array variables. Any variable may be used as an array; the declare builtin will explicitly declare an array. There is no maximum limit on the size of an array, nor any requirement that members be indexed or assigned contiguously. Arrays are indexed using integers and are zero-based.</p><p>＃ Tilde Expansion</p><p>~+ PWD<br>~- OLDPWD<br>~-2 ……</p><h1 id="Rd-Mark"><a href="#Rd-Mark" class="headerlink" title="Rd Mark"></a>Rd Mark</h1><p>Parameter Expansion</p></div></div><div class="comments" id="comments"><div id="disqus_switch" class="center"><a href="javascript:loadDisqus();">显示评论，需翻墙<br>Show Comments</a></div><script type="text/javascript">function loadDisqus(){$("#disqus_switch").hide(),$("#disqus_thread").show(),run_disqus_script("count.js"),run_disqus_script("embed.js")}</script><div id="disqus_thread" style="display:none"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><a href="/about/"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar_pretty_00.png" alt="IceHe"><p class="site-description motion-element white" itemprop="description"></p></div></a><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> &nbsp;订阅 IceHe</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/IceHe" target="_blank" title="GitHub">GitHub </a></span><span class="links-of-author-item"><a href="http://weibo.com/icedes" target="_blank" title="Weibo">Weibo </a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/icehe" target="_blank" title="Zhihu">Zhihu </a></span><span class="links-of-author-item"><a href="https://www.douban.com/people/IceHeGZ" target="_blank" title="Douban">Douban</a></span></div><div class="post-toc" style="max-height:1220px;width:calc(100% + 0px)" id="popular-post-div"><div class="post-toc-content"><ol class="nav hidden" id="popular-list"></ol></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#DEFINITIONS"><span class="nav-number">1.</span> <span class="nav-text">DEFINITIONS</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RESERVED-WORDS"><span class="nav-number">2.</span> <span class="nav-text">RESERVED WORDS</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pipelines"><span class="nav-number">3.</span> <span class="nav-text">Pipelines</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#List-序列"><span class="nav-number">4.</span> <span class="nav-text">List 序列</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Comments"><span class="nav-number">5.</span> <span class="nav-text">Comments</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Quotes"><span class="nav-number">6.</span> <span class="nav-text">Quotes</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Parameters"><span class="nav-number">7.</span> <span class="nav-text">Parameters</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Positional-Parameters"><span class="nav-number">8.</span> <span class="nav-text">Positional Parameters</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Arrays"><span class="nav-number">9.</span> <span class="nav-text">Arrays</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Rd-Mark"><span class="nav-number">10.</span> <span class="nav-text">Rd Mark</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2015-<span itemprop="copyrightYear">2017</span> &nbsp;<span class="author" itemprop="copyrightHolder">IceHe</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script><script type="text/javascript">function run_disqus_script(t){var e=document,s=e.createElement("script");s.src="https://https-icehe-me.disqus.com/"+t,s.setAttribute("data-timestamp",""+ +new Date),"count.js"==t&&(s.id="dsq-count-scr"),(e.head||e.body).appendChild(s)}var disqus_config=function(){this.page.url="http://icehe.me/notes/bash.html",this.page.identifier="notes/bash.html",this.page.title="Bash - Note"}</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(s=r[r.length-1],i=s.position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("u1mg4ase5iwhhnyqlavbmd5lkbj7mb5oy4linckob65z1axp","fe7peybzqmpgludkwu43fk15s655i8neejt3pkoezlqtbeu5")</script><script>function pvDesc(e){return(e/=100)>=10?Math.floor(e)/10+" k +":e>=1?Math.floor(e)+"00 +":"< 99"}function setPvAndFadeIn(e){var n=e.get("url"),t=e.get("time");if(t>=PV_SHOW_LIMIT){var o=document.getElementById(n);$(o).find(COUNT_CONTAINER_REF).text(pvDesc(t)),$(o).fadeIn()}}function showPv(e){var n=[],t=$(".leancloud_visitors");t.each(function(){n.push($(this).attr("id").trim())}),new AV.Query(e).containedIn("url",n).find().done(function(e){if(0!==e.length){for(o=0;o<e.length;o++)setPvAndFadeIn(e[o]);for(var o=0;o<n.length;o++){var s=n[o],i=document.getElementById(s),a=$(i).find(COUNT_CONTAINER_REF);""==a.text()&&a.text(0)}}else t.find(COUNT_CONTAINER_REF).text(0)}).fail(function(e,n){console.log("Error: "+n.code+" "+n.message)})}function addCount(e){var n=$(".leancloud_visitors"),t=n.attr("id").trim(),o=n.attr("data-flag-title").trim();new AV.Query(e).equalTo("url",t).find({success:function(n){if(n.length>0){var s=n[0];s.fetchWhenSave(!0),-1!=location.href.indexOf("icehe.me")&&-1==location.href.indexOf("icehe.me/notes/")&&(s.increment("time"),s.save(null,{success:function(e){},error:function(e,n){console.log("Failed to save Visitor num, with error message: "+n.message)}})),setPvAndFadeIn(s)}else{var i=new e,a=new AV.ACL;a.setPublicReadAccess(!0),a.setPublicWriteAccess(!0),i.setACL(a),i.set("title",o),i.set("url",t),i.set("time",1),i.save(null,{success:function(e){var n=$(document.getElementById(t));n.find(".leancloud-visitors-count").text(pvDesc(e.get("time"))),n.fadeIn()},error:function(e,n){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}function ranking(e,n){var t=$("#popular-list2"),o=1==t.length,s=o?20:10;(o||0!=(t=$("#popular-list")).length)&&new AV.Query(e).descending("time").limit(s+10).notContainedIn("url",["/about/","/bookmarks/","/reward/","/search/","/index/","/resume/","/linux/[06] Linux 通过 pip 安装使用 Shadowsocks - CentOS 7/","/linux/[05] 自动挂载 NTFS 格式的 硬盘分区 - CentOS 7/","/linux/[04] 安装 CentOS 7 后必做的 安全防范措施/","/linux/[03] Update Kernel 升级内核 - CentOS 7/","/linux/[02] Config System Envir 配置系统环境 - CentOS 7/","/linux/[01] 恢复 Windows 的 开机引导 - CentOS 7/","/linux/[00] U盘安装 CentOS 7/"]).limit(s).find().done(function(e){if(0!==e.length){t.append('<li class="nav-item nav-level-1 bold" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #ccc;"> <span class="nav-textwhite"><i class="fa fa-fire"></i> &nbsp; 热榜 </span></li>');for(var n=0;n<e.length;++n){var s=e[n],i=s.get("url"),a=s.get("title"),l=pvDesc(s.get("time"));t.append('<li class="nav-item nav-level-1" '+((n+1)%10==0?'style="border-bottom-width: 1px; border-bottom-style: solid;border-bottom-color: #ccc;"':"")+'> <span class="nav-number"> '+(n+1)%10+'. &nbsp;</span> <a class="nav-link" href="'+i+'"> <span class="nav-text"> '+a+' </span> </a> <span class="nav-number"> <sup> &nbsp;'+l+" </sup> </span> </li>")}o||t.append('<li class="nav-item nav-level-1 bold"> <span class="nav-text"><i class="fa fa-coffee"></i> &nbsp; 欢迎</span></li>'),t.fadeIn()}}).fail(function(e,n){console.log("Error: "+n.code+" "+n.message)})}var PV_SHOW_LIMIT=200,COUNT_CONTAINER_REF=".leancloud-visitors-count";$(function(){var e=AV.Object.extend("Counter");addCount(e),ranking(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script></body></html>