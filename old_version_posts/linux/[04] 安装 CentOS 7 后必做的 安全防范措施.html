<!doctype html><html class="theme-next mist" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="google34949e442e488102"><meta name="baidu-site-verification" content="04tLeUMqMf"><link href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.css.network/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css"><meta name="keywords" content=","><link rel="alternate" href="/atom.xml" title="IceHe" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/images/alphabet_letter_h.ico?v=5.1.1"><meta name="description" content="更改root密碼，新增一個普通帳號，禁止root使用ssh登入，使用非常規的ssh端口，啟用公鑰驗證登入ssh，每天自動更新，设置防火墙。"><meta name="keywords" content="CentOS"><meta property="og:type" content="website"><meta property="og:title" content="安装 CentOS 后的安全防范措施"><meta property="og:url" content="http://icehe.me/old_version_posts/linux/[04] 安装 CentOS 7 后必做的 安全防范措施.html"><meta property="og:site_name" content="IceHe"><meta property="og:description" content="更改root密碼，新增一個普通帳號，禁止root使用ssh登入，使用非常規的ssh端口，啟用公鑰驗證登入ssh，每天自動更新，设置防火墙。"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/1f0fcf2df1d7b4e35dce93fce4f4ffcb.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/bac70f0dba83328c6a84b73354ef9c8a.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/fd2783725dce3d626ca55ea5d47c0d75.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/29f63025f93fa1718fabcffef432286f.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/f9499f2dfc24e866169b710e3896f288.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/42ed043b684e7b62de45b6358bd81174.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/8393d5ef7e0bffc8879145c288660fdc.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/ce98b31ac457c7caf6333826223e5338.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/cc679614b0ba1ca85dcc08527708d020.png"><meta property="og:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/97bb67ed31b4fbd218adddf485130bde.png"><meta property="og:updated_time" content="2016-12-06T10:20:55.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="安装 CentOS 后的安全防范措施"><meta name="twitter:description" content="更改root密碼，新增一個普通帳號，禁止root使用ssh登入，使用非常規的ssh端口，啟用公鑰驗證登入ssh，每天自動更新，设置防火墙。"><meta name="twitter:image" content="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/1f0fcf2df1d7b4e35dce93fce4f4ffcb.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{display:"always",offset:12,offset_float:0,b2t:!1,scrollpercent:!0},fancybox:!0,motion:!1,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://icehe.me/old_version_posts/linux/[04] 安装 CentOS 7 后必做的 安全防范措施.html"><title>安装 CentOS 后的安全防范措施 | IceHe</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ba81ef13fc65c4dcf8cf8586d25818a4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">IceHe</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">More is in vain when less will serve.</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-quote-left"></i><br>文章</a></li><li class="menu-item menu-item-nav"><a href="/bookmarks" rel="section"><i class="menu-item-icon fa fa-fw fa-bookmark"></i><br>导航</a></li><li class="menu-item menu-item-cv"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-star"></i><br>简历</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav><style type="text/css">.bold{font-weight:700}.center{text-align:center}.hidden{display:none}.no_underline{border-bottom:0}.white{color:#fff}.pace .pace-progress{background:#000}</style></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><header class="post-header"><h2 class="post-title" itemprop="name headline">安装 CentOS 后的安全防范措施</h2><div class="post-meta"><div class="post-description">更改root密碼，新增一個普通帳號，禁止root使用ssh登入，使用非常規的ssh端口，啟用公鑰驗證登入ssh，每天自動更新，设置防火墙。</div></div></header><div style="word-wrap:break-word;-webkit-nbsp-mode:space;-webkit-line-break:after-white-space"><div>Ref From:&nbsp;<a href="http://www.hkpug.net/2014/09/18/%E5%AE%89%E8%A3%9D-centos-7-%E5%BE%8C%E5%BF%85%E5%81%9A%E7%9A%84%E4%B8%83%E4%BB%B6%E4%BA%8B/" shape="rect" target="_blank">http://www.hkpug.net/2014/09/18/%E5%AE%89%E8%A3%9D-centos-7-%E5%BE%8C%E5%BF%85%E5%81%9A%E7%9A%84%E4%B8%83%E4%BB%B6%E4%BA%8B/</a></div><div>Original Title:&nbsp;安裝 CentOS 7 後必做的七件事</div><div><br clear="none"></div><div><span style="color:#f60"><strong>Notice:</strong> 安装桌面版的 CentOS 后，一般为了简便，暂时只用做第三步——</span></div><div><span style="color:#f60">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;<strong>3. 禁止 root 使用 ssh 登入</strong></span></div><div><br clear="none"></div><div style="font-size:16px"><div style="text-align:center;font-family:verdana,arial,sans-serif;font-size:.9em;color:#333;background:#eee"><div style="text-align:center"><div style="text-align:left;background:#eee"><table style="font-size:100%;font-weight:inherit;font-style:inherit;font-variant:inherit"><tbody><tr><td colspan="1" rowspan="1" style="vertical-align:top"><div style="word-wrap:break-word;background:#eee"><div style="margin:5px 0 10px"><a href="http://www.centos.org/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank">CentOS</a> 是最多人用來運行伺服器的 Linux 版本，最新版本是 CentOS 7。<br clear="none">當你興趣勃勃地在一台主機或 VPS 上安裝 CentOS 7 後，首要的工作肯定是加強它的安全性，<br clear="none">以下列出的七件事，是你進一步配置系統和安裝其他軟件前必須做的。</div><div style="min-width:0;display:block;line-height:160%"><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em">1. 更改 root 密碼</h3><p style="margin:1em 0;padding:0;display:block">若果你是自行安裝 CentOS 7 的話，安裝程序會讓你自行設定 root 的密碼。<br clear="none">不過很多 VPS 服務商只會提供預先安裝好的 CentOS 7 映像檔，<br clear="none">這種情況下他們會透過主控界面告訴你 root 的密碼，<br clear="none">這個密碼的安全性誰也不知道，它是如何產生的呢？<br clear="none">隨機性可靠嗎？複雜性足夠嗎？<br clear="none">服務商的伺服器是否記錄了密碼的副本？<br clear="none">我們實在有必要第一時間重設這個密碼。</p><p style="margin:1em 0;padding:0;display:block">首先使用 <code style="font-family:&amp">ssh</code> 登入伺服器，在 Windows 可以使用 <a href="http://www.putty.org/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank">Putty</a>、<a href="http://ttssh2.sourceforge.jp/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank">Tera Term</a>&nbsp;或者在 <a href="http://cygwin.com/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank">Cygwin</a> 環境下執行 <a href="http://www.openssh.com/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank">OpenSSH</a>。<br clear="none">在 Mac 和 Linux 上只需在終端機 (terminal) 中執行以下指令便可以了，比 Windows 簡單得多：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/010.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="600px" height="69px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/1f0fcf2df1d7b4e35dce93fce4f4ffcb.png"></a></p><p style="margin:1em 0;padding:0;display:block">由於你從來沒有使用過 ssh 聯繫到這台伺服器，你的電腦會把伺服器的加密公鑰下載，<br clear="none">然後詢問你是否信任它，這台新鮮安裝好的 CentOS 7 應該還未引起黑客的興趣，<br clear="none">也不大可能在這麼短的時間內被攻陷，所以可以放心接受這個加密公鑰。<br clear="none">跟著輸入 root 的密碼登入伺服器：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/020.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="600px" height="94px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/bac70f0dba83328c6a84b73354ef9c8a.png"></a></p><p style="margin:1em 0;padding:0;display:block">登入後立即更改 root 的密碼，你需要輸入新密碼兩次：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/030.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="525px" height="114px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/fd2783725dce3d626ca55ea5d47c0d75.png"></a></p><p style="margin:1em 0;padding:0;display:block">好的密碼應該同時包含數字、小寫英文字母、大寫英文字母、和標點符號，最少 15 個字符，<br clear="none">這樣的密碼強度大概有 90 bit，勉強可以應付密碼被「暴力破解」，<br clear="none">當然我假設了你的密碼是真正隨機產生。</p><p style="margin:1em 0;padding:0;display:block">有些人喜歡把個人資料例如名字、出生日期、車牌號碼、地址、配偶和子女的名字等等崁入密碼中，<br clear="none">或者使用字典裏的字詞拼湊密碼，這樣密碼的強度將會大幅下降，甚至不堪一擊，<br clear="none">這些問題我曾經在《<a href="http://www.hkpug.net/2011/07/27/%E6%80%8E%E6%A8%A3%E7%AE%A1%E7%90%86%E5%AF%86%E7%A2%BC%EF%BC%9F/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank" title="如何管理密碼？">如何管理密碼？</a>》討論過。</p><p style="margin:1em 0;padding:0;display:block">網上有很多隨機密碼產生器，例如 <a href="https://www.random.org/" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank" title="RANDOM.ORG">RANDOM.ORG</a>，大都可用，<br clear="none">但記緊必須使用 HTTPS 造訪這些網站。<br clear="none">如果你有使用「密碼夾萬」一類的軟件，不妨使用它們內建的密碼產生器。</p><p style="margin:1em 0;padding:0;display:block">完成後<span style="color:red"><strong>不要</strong></span>登出系統，使用另一個視窗用新密碼嘗試登入，<br clear="none">即使失敗也可以在原來的視窗重複以上步驟。</p><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em">2. 新增一個普通帳號</h3><p style="margin:1em 0;padding:0;display:block">這一步連同下一步，相當於為一個城市築起兩道城牆，既可加強防衛，也建立了一道警報機制。<br clear="none">當敵人（黑客）卒然來襲，第一道城牆被襲擊和破壞，我們還有第二道城牆阻延一下，<br clear="none">有時間部署防衛甚至反擊。所以這是一個很多人忽略，但其實非常重要的步驟。</p><p style="margin:1em 0;padding:0;display:block">首先我們新增一個帳號：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/040.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="337px" height="49px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/29f63025f93fa1718fabcffef432286f.png"></a></p><p style="margin:1em 0;padding:0;display:block">這個新帳號 ahhang 沒有預設密碼，即是說登入 ahhang 時系統不用輸入密碼！<br clear="none">所以我們立即要設定密碼：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/050.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="511px" height="114px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/f9499f2dfc24e866169b710e3896f288.png"></a></p><p style="margin:1em 0;padding:0;display:block">有些人認為不應該把建立帳號和設定密碼兩件事分開來做，<br clear="none">一來可能會不慎遺忘，二來也給黑客一道時間縫隙登入這個新帳號，<br clear="none">所以他們會在 <code style="font-family:&amp">adduser</code> 指令中一併提供加密後的預設密碼。<br clear="none"><br clear="none">方法是加入 <code style="font-family:&amp">-p</code> 參數，不過這樣做也有風險，<br clear="none">因為黑客可以透過列出系統的進程，得知加密了的新密碼，然後把密碼破解。</p><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em"><span style="color:#f60">3. 禁止 root 使用 ssh 登入</span></h3><p style="margin:1em 0;padding:0;display:block">CentOS 7 預設容許任何帳號透過 <code style="font-family:&amp">ssh</code> 登入，包括 root 和一般帳號。<br clear="none">為了不讓 root 帳號被黑客暴力入侵，我們必須禁止 root 帳號的 <code style="font-family:&amp">ssh</code> 功能。<br clear="none"></p><p style="margin:1em 0;padding:0;display:block">事實上 root 也沒有必要 <code style="font-family:&amp">ssh</code> 登入伺服器，<br clear="none">因為只要使用 <code style="font-family:&amp">su</code> 或 <code style="font-family:&amp">sudo</code> (當然需要輸入 root 的密碼) 普通帳號便可以擁有 root 的權限。<br clear="none"></p><p style="margin:1em 0;padding:0;display:block">使用 <code style="font-family:&amp">vim</code> (或任何文本編輯器) 開啓 <code style="font-family:&amp">/etc/ssh/sshd_config</code>，尋找：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit">＃<span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">PermitRootLogin</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yes</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">修改為：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">PermitRootLogin</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">no</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><p style="margin:1em 0;padding:0;display:block">最後輸入以下指令重新啟動 <code style="font-family:&amp">sshd</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">systemctl</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">restart</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">sshd</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">.service</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">這樣黑客要取得 root 的權限，必須破解 root 和一個普通用戶的密碼，難度增加了。<br clear="none">完成後<span style="color:red"><strong>不要</strong></span>登出系統，使用另一個視窗嘗試登入 root 和普通帳號，測試無誤便可進行下一步。</p><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em">4. 使用非常規的 ssh 端口</h3><p style="margin:1em 0;padding:0;display:block"><code style="font-family:&amp">Ssh</code> 預設使用端口 22，這是在 IANA 註冊的官方端口，但沒有人說 ssh 不能使用其他端口。<br clear="none">|很多黑客專門向伺服器的 22 端口發動攻擊，即使你的伺服器固若金湯、牢不可破，<br clear="none">但是要系統日以繼夜接受攻擊，消耗的系統資源（網絡、處理器、記憶體等等）也不會少。<br clear="none">何況它是否真的牢不可破還說不定呢！<br clear="none">所以有必要讓 <code style="font-family:&amp">ssh</code> 使用其他端口，只讓有權使用 <code style="font-family:&amp">ssh</code> 的用戶知道。</p><p style="margin:1em 0;padding:0;display:block">使用 vim&nbsp; (或任何文本編輯器) 開啓 <code style="font-family:&amp">/etc/ssh/sshd_config</code>，尋找：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit">＃<span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#66cb76">Port</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#099">22</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">修改為：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#66cb76">Port</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#099">10837</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">你可以把 10837 改為任何 1024 – 65535 之間的任何數字。<br clear="none">若果怕與某些系統服務發生衝突，可以參考一下<a href="https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank">這裏</a>。</p><p style="margin:1em 0;padding:0;display:block">跟著重新啟動 <code style="font-family:&amp">sshd</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">systemctl</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">restart</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">sshd</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">.service</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">然後是設定防火牆，CentOS 7 的內核已經有防火牆 <code style="font-family:&amp">netfilter</code>，<br clear="none">但你的系統未必安裝了用戶界面，較前版本的 CentOS 預設使用 <code style="font-family:&amp">iptables。</code></p><p style="margin:1em 0;padding:0;display:block">但 CentOS 7 開始使用效能更高、穩定性更好的 <code style="font-family:&amp">firewalld。<br clear="none"></code>若果伺服器尚未安裝 <code style="font-family:&amp">firewalld</code>，可以使用以下指令安裝，<br clear="none">不確定是否已經安裝的話也可以輸入這個指令，它會告訴你已經安裝然後退出。</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">yum</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">install</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewalld</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">跟著啟動：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">systemctl</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">start</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewalld</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">設定 <code style="font-family:&amp">firewalld</code> 的方法有兩個，<br clear="none">第一個是修改 <code style="font-family:&amp">firewalld</code> 有關 <code style="font-family:&amp">sshd</code> 的設定，<br clear="none">把端口 22 改為 10837，這是正統的做法，但步驟比較多。<br clear="none">第二個是要求 <code style="font-family:&amp">firewalld</code> 開啓端口 10837，不指定它屬於哪一個服務，<br clear="none">這個做法通常處理臨時的端口開啓／封鎖，步驟簡單。</p><p style="margin:1em 0;padding:0;display:block">但是日後你要是忘記了這個端口為甚麼開啟了呢？<br clear="none">什麼時候開啟的呢？為了哪一項服務開啟呢？可能有點麻煩。<br clear="none"></p><p style="margin:1em 0;padding:0;display:block">我兩種方法都會介紹一下，但作為專業的系統管理員<br clear="none">（即使不是真正的專業，也應該具備這樣的心態），我<strong>推薦使用第一種方法</strong>。</p><h4 style="padding-top:0;padding-bottom:0;font-size:19px;margin:1.33em 0 .2em">設定防火牆方法一：</h4><p style="margin:1em 0;padding:0;display:block">複製 <code style="font-family:&amp">firewalld</code> 有關 <code style="font-family:&amp">sshd</code> 的設定檔案：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0 0 0 -27px;font-family:Monaco,MonacoRegular,&amp;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:700;color:#2bafaa">cp</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">usr</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">lib</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewalld</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">services</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">ssh</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">.xml</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">etc</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewalld</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">services</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">使用 <code style="font-family:&amp">vim</code>&nbsp; (或任何文本編輯器) 開啓 <code style="font-family:&amp">/etc/firewalld/services/ssh.xml</code>，尋找：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">&nbsp;&nbsp;</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">&lt;</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">port</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">protocol</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#1fbbdd">&quot;tcp&quot;</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">port</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#1fbbdd">&quot;22&quot;</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">&gt;</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">修改為：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">&nbsp;&nbsp;</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">&lt;</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">port</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">protocol</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#1fbbdd">&quot;tcp&quot;</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">port</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#1fbbdd">&quot;10837&quot;</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">&gt;</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">儲存後重新載入 <code style="font-family:&amp">firewalld</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewall</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">cmd</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">--</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">reload</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h4 style="padding-top:0;padding-bottom:0;font-size:19px;margin:1.33em 0 .2em">設定防火牆方法二：</h4><p style="margin:1em 0;padding:0;display:block">輸入以下指令：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewall</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">cmd</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">--</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">zone</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">public</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">--</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">add</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">port</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#099">10837</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">/</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">tcp</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">--</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">permanent</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">就是這樣簡單！</p><p style="margin:1em 0;padding:0;display:block">不論使用哪種方法，完成後<span style="color:red"><strong>不要</strong></span>登出系統，使用另一個視窗嘗試登入，例如：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">ssh</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#66cb76">p</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#099">10837</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">ahhang</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#333">@</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#099">192.168.1.188</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em">5. 啟用公鑰驗證登入 <code style="font-family:&amp">ssh</code></h3><p style="margin:1em 0;padding:0;display:block">現在只有普通帳號才能透過 <code style="font-family:&amp">ssh</code> 登入伺服器，<br clear="none">但是 <code style="font-family:&amp">ssh</code> 提供一個更先進更安全的驗證方法：公鑰驗證法。</p><p style="margin:1em 0;padding:0;display:block">首先每一名用戶建立一對加密鑰匙（密鑰和公鑰），<br clear="none">密鑰儲存在日常使用的電腦，公鑰則儲存在伺服器。</p><p style="margin:1em 0;padding:0;display:block">使用 <code style="font-family:&amp">ssh</code> 聯繫到伺服器的時候，電腦會把一些建立連線請求的資料，<br clear="none">其中包括帳號名稱和公鑰，並且把部分資料用密鑰製作數碼簽署，一股腦兒送到伺服器。<br clear="none">伺服器檢查自己的「公鑰庫」是否包含送來的公鑰。<br clear="none">有的話再驗證數碼簽署，成功的話便直接登入伺服器，無需輸入帳號密碼。</p><p style="margin:1em 0;padding:0;display:block">第一步在日常使用的電腦上使用 <code style="font-family:&amp">ssh-keygen</code> 指令建立一對加密鑰匙，<br clear="none">它會詢問儲存加密鑰匙的檔案名稱，和把鑰匙加密的密碼，<br clear="none">檔案名稱使用預設的路徑和名稱便可以，密碼則無需輸入：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/060.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="533px" height="316px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/42ed043b684e7b62de45b6358bd81174.png"></a></p><p style="margin:1em 0;padding:0;display:block">這個指令會創造兩個檔案，一個名為 <code style="font-family:&amp">id_rsa</code>，是你的 RSA 密鑰，<br clear="none">另一個是 <code style="font-family:&amp">id_rsa.pub</code>，是你的 RSA 公鑰。<br clear="none"></p><p style="margin:1em 0;padding:0;display:block">公鑰必需上傳到伺服器並且附加於用戶帳號裏面的 <code style="font-family:&amp">.ssh/authorized_keys</code> 檔案中，<br clear="none">這個檔案儲存所有可透過 <code style="font-family:&amp">ssh</code> 登入到這一個帳號的公鑰，一行一條公鑰：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/070.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="600px" height="103px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/8393d5ef7e0bffc8879145c288660fdc.png"></a></p><p style="margin:1em 0;padding:0;display:block">順便一提，目錄 <code style="font-family:&amp">.ssh</code> 和 <code style="font-family:&amp">authorized_keys</code> 除了 owner 之外，其他人均不能有寫入的權限，<br clear="none">否則 <code style="font-family:&amp">sshd</code> 不會讀取，換句話說，兩者最寬鬆的權限是 755：<br clear="none"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/080.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="600px" height="91px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/ce98b31ac457c7caf6333826223e5338.png"></a></p><p style="margin:1em 0;padding:0;display:block">使用公鑰驗證法登入 <code style="font-family:&amp">ssh</code> 又省力又安全，<br clear="none">因為我們不用輸入密碼，自然也沒有密碼被盜取的憂慮，<br clear="none">簡簡單單地輸入連線指令便可以了。</p><p style="margin:1em 0;padding:0;display:block">但是存放在日常電腦中的密鑰卻帶來新的安全隱患，<br clear="none">萬一密鑰被盜取了，其他人豈不是可以隨便登入伺服器？<br clear="none">現在是「雙重驗證」(two-factor authentication) 隆重登場的時候。</p><p style="margin:1em 0;padding:0;display:block">雙重驗證的理念是我們必須向伺服器證明兩種不同性質的東西，才能成功驗證身分。<br clear="none">第一樣是我們知道什麼，第二樣是我們擁有什麼。</p><p style="margin:1em 0;padding:0;display:block">首先伺服器會要求我們輸入密碼，我們知道密碼，過了第一關。<br clear="none">跟著伺服器要求我們證明擁有公鑰驗證法中的密鑰，<br clear="none">透過上面的設定程序我們也通過了驗證，過了第二關。<br clear="none">現在伺服器才會讓我們進入系統。</p><p style="margin:1em 0;padding:0;display:block">設定 ssh 的雙重驗證法很簡單，<br clear="none">使用 <code style="font-family:&amp">vim</code>&nbsp; (或任何文本編輯器) 開啓 <code style="font-family:&amp">/etc/ssh/sshd_config</code>，<br clear="none">在檔案的末端假如這一行：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">AuthenticationMethods</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">publickey</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#333">,</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">password</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">它告訴伺服器用戶必須擁有合法的公鑰，和輸入正確的密碼才能成功登入。<br clear="none">修改完成後重新啟動 <code style="font-family:&amp">sshd</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">systemctl</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">restart</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">sshd</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">.service</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">完成後<span style="color:red"><strong>不要</strong></span>登出系統，使用另一個視窗嘗試登入，測試無誤便可進行下一步。</p><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em">6. 更新、更新、每天更新、每天自動更新</h3><p style="margin:1em 0;padding:0;display:block">每一天都有成千上萬的黑客在世界各地尋找 Linux 系統和常見軟件的安全漏洞，<br clear="none">一有發現便會發動規模龐大而迅速的網絡攻擊，務求在我們來得及反應前把系統攻陷。<br clear="none"></p><p style="margin:1em 0;padding:0;display:block">不要以為黑客都只是十來歲的年輕小毛頭，<br clear="none">大部分黑客背後都有勢力龐大、資源幾乎無限的國家機構支持，<br clear="none">有些甚至屬於這些機構的雇員，美國的 NSA，英國的 GQHC，中國的無名黑客隊伍，<br clear="none">都是比較明目張膽由國家支持的網絡黑幫，可見我們的系統時時刻刻都被凶狠之徒盯著，<br clear="none">保持軟件在最新的狀態是其中一項我們必須做，也很容易做到的工作。</p><p style="margin:1em 0;padding:0;display:block">首先我們立即手動更新所有預先安裝的軟件：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yum</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#66cb76">y</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">update</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">跟著設定系統定時自動更新，第一步確定伺服器是否安裝了自動執行指令的工具，<br clear="none">跟著使用 <code style="font-family:&amp">yum</code> 一個名叫 <code style="font-family:&amp">yum-cron</code> 插件。</p><p style="margin:1em 0;padding:0;display:block">CentOS 7 使用數個軟件來自動執行指令：<code style="font-family:&amp">cron</code>、<code style="font-family:&amp">anacron</code>、<code style="font-family:&amp">at</code> 和 <code style="font-family:&amp">batch</code>，<br clear="none">其中 <code style="font-family:&amp">cron</code> 和 <code style="font-family:&amp">anacron</code> 用來定期重複執行指令，<code style="font-family:&amp">At</code> 和 <code style="font-family:&amp">batch</code> 則用來在特定時間執行一次性的指令。</p><p style="margin:1em 0;padding:0;display:block">我們將會使用 <code style="font-family:&amp">cron</code> 和 <code style="font-family:&amp">anacron</code>，兩者的分別這裏不細表了，將來有機會再討論，<br clear="none">現在使用以下指令安裝 <code style="font-family:&amp">cron</code> 和 <code style="font-family:&amp">anacron</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yum</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#66cb76">y</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">install</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">cronie</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">下一步就是安裝 <code style="font-family:&amp">yum-cron</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yum</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#66cb76">y</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">install</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yum</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">cron</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">其實你可以使用一個指令同時安裝 <code style="font-family:&amp">cronie</code> 和 <code style="font-family:&amp">yum-cron</code>，甚至單獨安裝 <code style="font-family:&amp">yum-cron</code> 也可以，<br clear="none">因為 <code style="font-family:&amp">yum</code> 會自動檢測到 <code style="font-family:&amp">yum-cron</code> 需要 <code style="font-family:&amp">cronie</code> 然後自動替你安裝，<br clear="none">上面分開兩個指令純粹令大家容易明白。</p><p style="margin:1em 0;padding:0;display:block">完成後系統多了數個檔案，比較重要的包括：</p><ul style="margin-top:10px;margin-bottom:10px;padding-top:0;padding-bottom:0"><li><code style="font-family:&amp">/etc/cron.daily/0yum.cron</code><br clear="none"><code style="font-family:&amp">Anacron</code> 每天執行這個檔案一次，它根據配置檔案 /etc/yum/yum-cron.conf 來更新軟件</li><li><code style="font-family:&amp">/etc/yum/yum-cron.conf</code><br clear="none">這是每天執行 <code style="font-family:&amp">yum-cron</code> 的配置檔案，預設只會下載更新的軟件，並不安裝，<br clear="none">用意是讓管理員檢視 <code style="font-family:&amp">yum-cron</code> 的輸出，選取需要更新的軟件進行手動安裝。</li></ul><p style="margin:1em 0;padding:0;display:block">跟著我們修改配置檔案，讓 <code style="font-family:&amp">yum-cron</code> 自動更新軟件，使用 <code style="font-family:&amp">vim（</code>或任何文本編輯器）<strong>開啓<br clear="none">/etc/yum/yum-cron.conf</strong>，尋找：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">apply_updates</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">no</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">修改為：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">apply_updates</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">=</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yes</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">確認一下 <code style="font-family:&amp">update_messages = yes</code>, <code style="font-family:&amp">download_updates = yes</code>, <code style="font-family:&amp">apply_updates = yes</code>，正如下圖：</p><p style="margin:1em 0;padding:0;display:block"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/090.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="565px" height="291px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/cc679614b0ba1ca85dcc08527708d020.png"></a><br clear="none"></p><p style="margin:1em 0;padding:0;display:block">最後，啟動 <code style="font-family:&amp">crond</code> 和 <code style="font-family:&amp">yum-cron</code>：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">2</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">systemctl</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">start</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">crond</span></div><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">systemctl</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">start</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">yum</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">cron</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block"><br clear="none"></p><h3 style="padding-top:0;padding-bottom:0;font-size:24px;line-height:1.3;margin:1em 0 .2em">7. 防火牆</h3><p style="margin:1em 0;padding:0;display:block">防火牆的作用好比網絡警察，它監察所有進出系統的 IP 封包，<br clear="none">哪些端口容許封包進入，哪些端口容許封包外出等等，<br clear="none">都由防火牆控制，保護使用這些端口的應用程式.<br clear="none">所以設定防火牆是極重要的工作。</p><p style="margin:1em 0;padding:0;display:block">過濾封包功能的 netfilter 已經內建在 CentOS 7 的內核，<br clear="none">但是配置 netfilter 的界面程式 firewalld 卻未必有安裝，<br clear="none">不論是否已經安裝，都可以執行下面的安裝指令：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:#f4f4f4;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">yum</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:teal">install</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewalld</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block">跟著查看一下防火牆現在開啟了哪些服務和端口：</p><div style="text-align:left;box-sizing:border-box;overflow:hidden;position:relative;direction:ltr;width:100%;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-bottom:12px;font-size:12px!important;line-height:15px!important;border:1px solid #dedede;background-color:#f8f8ff;margin-top:12px;height:auto"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;width:100%;overflow:hidden;position:relative;z-index:1"><table style="font-size:12px;font-weight:inherit;font-style:inherit;font-variant:inherit;border:none;padding:0;margin:0;font-family:Monaco,MonacoRegular,&amp;margin-top:0;margin-right:0;margin-bottom:0;width:auto;border-spacing:0;table-layout:auto;background:0 0"><tbody><tr style="font-family:Monaco,MonacoRegular,&amp;border:none;vertical-align:top;margin:0;background:0 50%"><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;border:none;background-color:#eee"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 50%;white-space:nowrap;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:right;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit;min-width:1.2em;color:#aaa;border-right-style:solid;border-right-width:1px;border-right-color:#dedede">1</div></div></td><td colspan="1" rowspan="1" style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;background:0 50%;text-align:left;width:100%;border:none"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0;margin:0;text-align:left;background:0 0;color:#000;white-space:pre;overflow:visible;tab-size:4;padding-top:5px;padding-bottom:3px;font-size:12px!important;line-height:15px!important;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4"><div style="font-family:Monaco,MonacoRegular,&amp;padding:0 5px;margin:0;text-align:left;background:0 50%;height:inherit;font-size:inherit;line-height:inherit;font-weight:inherit"><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">firewall</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">cmd</span> <span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">--</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">list</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#006fe0">-</span><span style="font-family:Monaco,MonacoRegular,&amp;font-size:inherit;line-height:inherit;font-weight:inherit;color:#002d7a">all</span></div></div></td></tr></tbody></table></div></div><p style="margin:1em 0;padding:0;display:block"><a href="http://www.hkpug.net/wp-content/uploads/2014/09/100.png" shape="rect" style="color:#00f;font-weight:400;text-decoration:none" target="_blank"><img width="410px" height="208px" src="http://7vzp68.com1.z0.glb.clouddn.com/%5B04%5D%20%E5%AE%89%E8%A3%85%20CentOS%207%20%E5%90%8E%E5%BF%85%E5%81%9A%E7%9A%84%20%E5%AE%89%E5%85%A8%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD/97bb67ed31b4fbd218adddf485130bde.png"></a><br clear="none"></p><p style="margin:1em 0;padding:0;display:block">上圖可見防火牆只開啟了 DHCP 客戶端和 ssh 兩個服務的通訊端口。<br clear="none">倘若日後安裝了其他網絡軟件，例如網站伺服器、域名伺服器等等，<br clear="none">必須要檢查安裝程式有否開啓他們的通訊端口，沒有的話便要手動開啓。</p><p style="margin:1em 0;padding:0;display:block">如果好像前面第四點那樣使用了非常規的通訊端口，也可能要手動配置防火牆。<br clear="none">防火牆詳細的配置方法超出了本文的討論範圍，將來有機會再談。</p></div></div></td></tr></tbody></table></div></div></div></div><div><br clear="none"></div></div></div></div><div class="comments" id="comments"><div id="disqus_switch" class="center"><a href="javascript:loadDisqus();">显示评论，需翻墙<br>Show Comments</a></div><script type="text/javascript">function loadDisqus(){$("#disqus_switch").hide(),$("#disqus_thread").show(),run_disqus_script("count.js"),run_disqus_script("embed.js")}</script><div id="disqus_thread" style="display:none"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><a href="/about/"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar_pretty_00.png" alt="IceHe"><p class="site-description motion-element white" itemprop="description"></p></div></a><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> &nbsp;订阅 IceHe</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/IceHe" target="_blank" title="GitHub">GitHub </a></span><span class="links-of-author-item"><a href="http://weibo.com/icedes" target="_blank" title="微博">微博 </a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/icehe" target="_blank" title="知乎">知乎 </a></span><span class="links-of-author-item"><a href="https://www.douban.com/people/IceHeGZ" target="_blank" title="豆瓣">豆瓣</a></span></div><div class="post-toc" style="max-height:1220px;width:calc(100% + 0px)" id="popular-post-div"><div class="post-toc-content"><ol class="nav hidden" id="popular-list"></ol></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">1.</span> <span class="nav-text">1. 更改 root 密碼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">2.</span> <span class="nav-text">2. 新增一個普通帳號</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">3.</span> <span class="nav-text">3. 禁止 root 使用 ssh 登入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">4.</span> <span class="nav-text">4. 使用非常規的 ssh 端口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#undefined"><span class="nav-number">4.1.</span> <span class="nav-text">設定防火牆方法一：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#undefined"><span class="nav-number">4.2.</span> <span class="nav-text">設定防火牆方法二：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">5.</span> <span class="nav-text">5. 啟用公鑰驗證登入 ssh</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">6.</span> <span class="nav-text">6. 更新、更新、每天更新、每天自動更新</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">7.</span> <span class="nav-text">7. 防火牆</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2015-<span itemprop="copyrightYear">2017</span> &nbsp;<span class="author" itemprop="copyrightHolder">IceHe</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/velocity/1.5.0/velocity.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/velocity/1.5.0/velocity.ui.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/motion.js/0.3.0/motion.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/motion.js/0.3.0/motion.min.js"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script><script type="text/javascript" src="//cdn.bootcss.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"></script><script type="text/javascript">function run_disqus_script(t){var e=document,i=e.createElement("script");i.src="https://https-icehe-me.disqus.com/"+t,i.setAttribute("data-timestamp",""+ +new Date),"count.js"==t&&(i.id="dsq-count-scr"),(e.head||e.body).appendChild(i)}var disqus_config=function(){this.page.url="http://icehe.me/old_version_posts/linux/[04] 安装 CentOS 7 后必做的 安全防范措施.html",this.page.identifier="old_version_posts/linux/[04] 安装 CentOS 7 后必做的 安全防范措施.html",this.page.title="安装 CentOS 后的安全防范措施"}</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(s=r[r.length-1],i=s.position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("u1mg4ase5iwhhnyqlavbmd5lkbj7mb5oy4linckob65z1axp","fe7peybzqmpgludkwu43fk15s655i8neejt3pkoezlqtbeu5")</script><script>function pvDesc(e){return(e/=100)>=10?Math.floor(e)/10+" k +":e>=1?Math.floor(e)+"00 +":"< 99"}function setPvAndFadeIn(e){var n=e.get("url"),t=e.get("time");if(t>=PV_SHOW_LIMIT){var o=document.getElementById(n);$(o).find(COUNT_CONTAINER_REF).text(pvDesc(t)),$(o).fadeIn()}}function showPv(e){var n=[],t=$(".leancloud_visitors");t.each(function(){n.push($(this).attr("id").trim())}),new AV.Query(e).containedIn("url",n).find().done(function(e){if(0!==e.length){for(o=0;o<e.length;o++)setPvAndFadeIn(e[o]);for(var o=0;o<n.length;o++){var s=n[o],i=document.getElementById(s),a=$(i).find(COUNT_CONTAINER_REF);""==a.text()&&a.text(0)}}else t.find(COUNT_CONTAINER_REF).text(0)}).fail(function(e,n){console.log("Error: "+n.code+" "+n.message)})}function addCount(e){var n=$(".leancloud_visitors"),t=n.attr("id").trim(),o=n.attr("data-flag-title").trim();new AV.Query(e).equalTo("url",t).find({success:function(n){if(n.length>0){var s=n[0];s.fetchWhenSave(!0),-1!=location.href.indexOf("icehe.me")&&-1==location.href.indexOf("icehe.me/notes/")&&(s.increment("time"),s.save(null,{success:function(e){},error:function(e,n){console.log("Failed to save Visitor num, with error message: "+n.message)}})),setPvAndFadeIn(s)}else{var i=new e,a=new AV.ACL;a.setPublicReadAccess(!0),a.setPublicWriteAccess(!0),i.setACL(a),i.set("title",o),i.set("url",t),i.set("time",1),i.save(null,{success:function(e){var n=$(document.getElementById(t));n.find(".leancloud-visitors-count").text(pvDesc(e.get("time"))),n.fadeIn()},error:function(e,n){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}function ranking(e,n){var t=$("#popular-list2"),o=1==t.length,s=o?20:10;(o||0!=(t=$("#popular-list")).length)&&new AV.Query(e).descending("time").limit(s+10).notContainedIn("url",["/about/","/bookmarks/","/reward/","/search/","/index/","/resume/","/linux/[06] Linux 通过 pip 安装使用 Shadowsocks - CentOS 7/","/linux/[05] 自动挂载 NTFS 格式的 硬盘分区 - CentOS 7/","/linux/[04] 安装 CentOS 7 后必做的 安全防范措施/","/linux/[03] Update Kernel 升级内核 - CentOS 7/","/linux/[02] Config System Envir 配置系统环境 - CentOS 7/","/linux/[01] 恢复 Windows 的 开机引导 - CentOS 7/","/linux/[00] U盘安装 CentOS 7/"]).limit(s).find().done(function(e){if(0!==e.length){t.append('<li class="nav-item nav-level-1 bold" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #ccc;"> <span class="nav-textwhite"><i class="fa fa-fire"></i> &nbsp; 热榜 </span></li>');for(var n=0;n<e.length;++n){var s=e[n],i=s.get("url"),a=s.get("title"),l=pvDesc(s.get("time"));t.append('<li class="nav-item nav-level-1" '+((n+1)%10==0?'style="border-bottom-width: 1px; border-bottom-style: solid;border-bottom-color: #ccc;"':"")+'> <span class="nav-number"> '+(n+1)%10+'. &nbsp;</span> <a class="nav-link" href="'+i+'"> <span class="nav-text"> '+a+' </span> </a> <span class="nav-number"> <sup> &nbsp;'+l+" </sup> </span> </li>")}o||t.append('<li class="nav-item nav-level-1 bold"> <span class="nav-text"><i class="fa fa-coffee"></i> &nbsp; 欢迎</span></li>'),t.fadeIn()}}).fail(function(e,n){console.log("Error: "+n.code+" "+n.message)})}var PV_SHOW_LIMIT=200,COUNT_CONTAINER_REF=".leancloud-visitors-count";$(function(){var e=AV.Object.extend("Counter");addCount(e),ranking(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/javascript" src="//cdn.bootcss.com/js-cookie/latest/js.cookie.min.js"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script></body></html>